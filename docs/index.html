<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¿ãƒ€ã‚«ãƒ¨ QRãƒãƒ£ãƒªãƒ†ã‚£ãƒ»ã‚³ãƒã‚¯ãƒˆ - è¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</title>
    <link rel="icon" type="image/jpeg" href="assets/tadakayo-logo.jpg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Noto+Sans+JP:wght@400;500;700&family=Outfit:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        :root {
            --brand: #E52D27;
            --brand-dark: #c41e1a;
            --brand-glow: rgba(229, 45, 39, 0.3);

            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #21262d;
            --bg-elevated: #30363d;

            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --text-muted: #6e7681;

            --border: #30363d;
            --border-light: #21262d;

            --accent-blue: #58a6ff;
            --accent-green: #3fb950;
            --accent-yellow: #d29922;
            --accent-purple: #a371f7;
            --accent-orange: #f0883e;

            --sidebar-width: 280px;
            --header-height: 72px;

            --font-display: 'Outfit', sans-serif;
            --font-body: 'Noto Sans JP', sans-serif;
            --font-mono: 'JetBrains Mono', monospace;

            --shadow-sm: 0 1px 2px rgba(0,0,0,0.3);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.4);
            --shadow-lg: 0 8px 24px rgba(0,0,0,0.5);
            --shadow-glow: 0 0 20px var(--brand-glow);
        }

        /* ===== LIGHT THEME ===== */
        [data-theme="light"] {
            --bg-primary: #ffffff;
            --bg-secondary: #f6f8fa;
            --bg-tertiary: #eaeef2;
            --bg-elevated: #d0d7de;

            --text-primary: #1f2328;
            --text-secondary: #57606a;
            --text-muted: #8c959f;

            --border: #d0d7de;
            --border-light: #eaeef2;

            --accent-blue: #0969da;
            --accent-green: #1a7f37;
            --accent-yellow: #9a6700;
            --accent-purple: #8250df;
            --accent-orange: #bc4c00;

            --shadow-sm: 0 1px 2px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.12);
            --shadow-lg: 0 8px 24px rgba(0,0,0,0.16);
        }

        [data-theme="light"] code {
            background: #eff1f3;
            color: #cf222e;
        }

        [data-theme="light"] .hero h1 {
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--text-secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            scroll-padding-top: calc(var(--header-height) + 24px);
        }

        body {
            font-family: var(--font-body);
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.7;
            font-size: 15px;
        }

        /* ===== HEADER ===== */
        .site-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: var(--header-height);
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            z-index: 1000;
            backdrop-filter: blur(12px);
        }

        .header-inner {
            max-width: 1600px;
            margin: 0 auto;
            padding: 0 24px;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .logo-img {
            width: 44px;
            height: 44px;
            border-radius: 10px;
            border: 2px solid var(--brand);
            box-shadow: var(--shadow-glow);
        }

        .logo-text {
            display: flex;
            flex-direction: column;
        }

        .logo-title {
            font-family: var(--font-display);
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-primary);
            letter-spacing: -0.02em;
        }

        .logo-subtitle {
            font-size: 0.75rem;
            color: var(--text-secondary);
            letter-spacing: 0.02em;
        }

        .header-badges {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            font-family: var(--font-display);
            letter-spacing: 0.02em;
        }

        .badge-tech {
            background: var(--bg-tertiary);
            color: var(--accent-blue);
            border: 1px solid var(--border);
        }

        .badge-demo {
            background: linear-gradient(135deg, var(--brand), var(--brand-dark));
            color: white;
            box-shadow: var(--shadow-glow);
        }

        .header-cta {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .btn-demo {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: var(--brand);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-family: var(--font-display);
            font-weight: 600;
            font-size: 0.85rem;
            transition: all 0.2s;
            box-shadow: var(--shadow-glow);
        }

        .btn-demo:hover {
            background: var(--brand-dark);
            transform: translateY(-1px);
            box-shadow: 0 0 30px var(--brand-glow);
        }

        /* ===== SIDEBAR ===== */
        .sidebar {
            position: fixed;
            top: var(--header-height);
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - var(--header-height));
            background: var(--bg-secondary);
            border-right: 1px solid var(--border);
            overflow-y: auto;
            padding: 24px 0;
            z-index: 100;
        }

        .sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: transparent;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 3px;
        }

        .nav-section {
            margin-bottom: 24px;
        }

        .nav-label {
            padding: 0 24px;
            margin-bottom: 8px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-muted);
            font-family: var(--font-display);
        }

        .nav-list {
            list-style: none;
        }

        .nav-item a {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 24px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.15s;
            border-left: 3px solid transparent;
        }

        .nav-item a:hover {
            color: var(--text-primary);
            background: var(--bg-tertiary);
        }

        .nav-item a.active {
            color: var(--brand);
            background: rgba(229, 45, 39, 0.1);
            border-left-color: var(--brand);
        }

        .nav-icon {
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }

        /* ===== MAIN CONTENT ===== */
        .main-content {
            margin-left: var(--sidebar-width);
            margin-top: var(--header-height);
            min-height: calc(100vh - var(--header-height));
        }

        .content-wrapper {
            max-width: 960px;
            margin: 0 auto;
            padding: 48px 48px 96px;
        }

        /* ===== HERO SECTION ===== */
        .hero {
            padding: 64px 0 48px;
            border-bottom: 1px solid var(--border);
            margin-bottom: 48px;
        }

        .hero-content {
            max-width: 960px;
            margin: 0 auto;
            padding: 0 48px;
        }

        .hero-eyebrow {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 14px;
            background: var(--bg-tertiary);
            border-radius: 20px;
            font-size: 0.8rem;
            color: var(--accent-green);
            font-family: var(--font-mono);
            margin-bottom: 24px;
            border: 1px solid var(--border);
        }

        .hero h1 {
            font-family: var(--font-display);
            font-size: 2.8rem;
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: 16px;
            letter-spacing: -0.03em;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--text-secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero p {
            font-size: 1.15rem;
            color: var(--text-secondary);
            max-width: 640px;
            line-height: 1.8;
        }

        .hero-highlight {
            color: var(--brand);
            font-weight: 600;
        }

        /* ===== SECTION STYLES ===== */
        section {
            padding: 48px 0;
            border-bottom: 1px solid var(--border-light);
        }

        section:last-child {
            border-bottom: none;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 24px;
        }

        .section-icon {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-tertiary);
            border-radius: 8px;
            font-size: 1.2rem;
        }

        h2 {
            font-family: var(--font-display);
            font-size: 1.6rem;
            font-weight: 700;
            letter-spacing: -0.02em;
            color: var(--text-primary);
        }

        h3 {
            font-family: var(--font-display);
            font-size: 1.15rem;
            font-weight: 600;
            margin: 36px 0 16px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        h3::before {
            content: '';
            width: 3px;
            height: 18px;
            background: var(--brand);
            border-radius: 2px;
        }

        p {
            color: var(--text-secondary);
            margin-bottom: 16px;
        }

        /* ===== CARDS ===== */
        .card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 24px;
            margin: 20px 0;
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 16px;
            margin: 24px 0;
        }

        .feature-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 24px;
            transition: all 0.2s;
        }

        .feature-card:hover {
            border-color: var(--brand);
            box-shadow: var(--shadow-glow);
            transform: translateY(-2px);
        }

        .feature-card h4 {
            font-family: var(--font-display);
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .feature-card p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin: 0;
        }

        /* ===== TECH TAGS ===== */
        .tech-stack {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 16px 0;
        }

        .tech-tag {
            display: inline-flex;
            align-items: center;
            padding: 6px 12px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 6px;
            font-family: var(--font-mono);
            font-size: 0.8rem;
            color: var(--accent-blue);
            transition: all 0.15s;
        }

        .tech-tag:hover {
            border-color: var(--accent-blue);
            background: rgba(88, 166, 255, 0.1);
        }

        /* ===== ALERTS ===== */
        .alert {
            display: flex;
            gap: 16px;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            border: 1px solid;
        }

        .alert-icon {
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .alert-content h4 {
            font-family: var(--font-display);
            font-size: 0.95rem;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .alert-content p {
            font-size: 0.9rem;
            margin: 0;
            line-height: 1.6;
        }

        .alert-success {
            background: rgba(63, 185, 80, 0.1);
            border-color: rgba(63, 185, 80, 0.3);
        }

        .alert-success .alert-icon,
        .alert-success h4 {
            color: var(--accent-green);
        }

        .alert-warning {
            background: rgba(210, 153, 34, 0.1);
            border-color: rgba(210, 153, 34, 0.3);
        }

        .alert-warning .alert-icon,
        .alert-warning h4 {
            color: var(--accent-yellow);
        }

        .alert-info {
            background: rgba(88, 166, 255, 0.1);
            border-color: rgba(88, 166, 255, 0.3);
        }

        .alert-info .alert-icon,
        .alert-info h4 {
            color: var(--accent-blue);
        }

        /* ===== STATUS BADGES ===== */
        .status {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            font-family: var(--font-display);
        }

        .status-done {
            background: rgba(63, 185, 80, 0.15);
            color: var(--accent-green);
        }

        .status-progress {
            background: rgba(210, 153, 34, 0.15);
            color: var(--accent-yellow);
        }

        .status-pending {
            background: var(--bg-tertiary);
            color: var(--text-muted);
        }

        /* ===== TABLES ===== */
        .table-wrapper {
            overflow-x: auto;
            margin: 20px 0;
            border: 1px solid var(--border);
            border-radius: 12px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 14px 18px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            background: var(--bg-tertiary);
            font-family: var(--font-display);
            font-weight: 600;
            font-size: 0.85rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover td {
            background: var(--bg-secondary);
        }

        /* ===== CODE ===== */
        code {
            font-family: var(--font-mono);
            font-size: 0.85em;
            background: var(--bg-tertiary);
            padding: 2px 8px;
            border-radius: 4px;
            color: var(--accent-orange);
        }

        .code-block {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
            font-family: var(--font-mono);
            font-size: 0.85rem;
            line-height: 1.8;
            color: var(--text-secondary);
        }

        /* ===== MERMAID ===== */
        .mermaid {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 32px;
            margin: 24px 0;
            overflow-x: auto;
        }

        /* ===== LISTS ===== */
        ul, ol {
            padding-left: 24px;
            margin: 16px 0;
        }

        li {
            color: var(--text-secondary);
            margin-bottom: 8px;
            line-height: 1.7;
        }

        li strong {
            color: var(--text-primary);
        }

        /* ===== FOOTER ===== */
        .site-footer {
            margin-left: var(--sidebar-width);
            background: var(--bg-secondary);
            border-top: 1px solid var(--border);
            padding: 48px;
            text-align: center;
        }

        .footer-content {
            max-width: 960px;
            margin: 0 auto;
        }

        .footer-brand {
            font-family: var(--font-display);
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 24px;
            margin-bottom: 16px;
        }

        .footer-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.15s;
        }

        .footer-links a:hover {
            color: var(--brand);
        }

        .footer-meta {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s;
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content,
            .site-footer {
                margin-left: 0;
            }

            .content-wrapper {
                padding: 32px 24px 64px;
            }

            .hero-content {
                padding: 0 24px;
            }

            .header-badges {
                display: none;
            }
        }

        @media (max-width: 640px) {
            .hero h1 {
                font-size: 2rem;
            }

            .card-grid {
                grid-template-columns: 1fr;
            }

            .header-cta .btn-demo {
                display: none;
            }
        }

        /* ===== MOBILE NAV TOGGLE ===== */
        .nav-toggle {
            display: none;
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 8px;
        }

        @media (max-width: 1024px) {
            .nav-toggle {
                display: block;
            }
        }

        /* ===== SCROLL PROGRESS ===== */
        .scroll-progress {
            position: fixed;
            top: var(--header-height);
            left: 0;
            height: 2px;
            background: var(--brand);
            z-index: 999;
            transition: width 0.1s;
        }

        /* ===== THEME TOGGLE ===== */
        .theme-toggle {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.2s;
            color: var(--text-secondary);
        }

        .theme-toggle:hover {
            background: var(--bg-elevated);
            color: var(--text-primary);
            border-color: var(--brand);
        }

        .theme-toggle .icon-sun {
            display: none;
        }

        .theme-toggle .icon-moon {
            display: block;
        }

        [data-theme="light"] .theme-toggle .icon-sun {
            display: block;
        }

        [data-theme="light"] .theme-toggle .icon-moon {
            display: none;
        }
    </style>
</head>
<body>
    <div class="scroll-progress" id="scrollProgress"></div>

    <!-- HEADER -->
    <header class="site-header">
        <div class="header-inner">
            <div class="logo-section">
                <button class="nav-toggle" onclick="toggleSidebar()">â˜°</button>
                <img src="assets/tadakayo-logo.jpg" alt="ã‚¿ãƒ€ã‚«ãƒ¨" class="logo-img">
                <div class="logo-text">
                    <span class="logo-title">QRãƒãƒ£ãƒªãƒ†ã‚£ãƒ»ã‚³ãƒã‚¯ãƒˆ</span>
                    <span class="logo-subtitle">è¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</span>
                </div>
            </div>
            <div class="header-badges">
                <span class="badge badge-tech">GCP Serverless</span>
                <span class="badge badge-demo">ãƒ‡ãƒ¢ç‰ˆå…¬é–‹ä¸­</span>
            </div>
            <div class="header-cta">
                <button class="theme-toggle" onclick="toggleTheme()" title="ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆ">
                    <span class="icon-moon">ğŸŒ™</span>
                    <span class="icon-sun">â˜€ï¸</span>
                </button>
                <a href="https://qr-payment-api-sandbox-yggvw3tpqa-an.a.run.app/donate" target="_blank" class="btn-demo">
                    ãƒ‡ãƒ¢ã‚’è©¦ã™ â†’
                </a>
            </div>
        </div>
    </header>

    <!-- SIDEBAR -->
    <nav class="sidebar" id="sidebar">
        <div class="nav-section">
            <div class="nav-label">ã¯ã˜ã‚ã«</div>
            <ul class="nav-list">
                <li class="nav-item"><a href="#overview"><span class="nav-icon">ğŸ“‹</span>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦</a></li>
                <li class="nav-item"><a href="#architecture"><span class="nav-icon">ğŸ—ï¸</span>ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£</a></li>
            </ul>
        </div>
        <div class="nav-section">
            <div class="nav-label">ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ</div>
            <ul class="nav-list">
                <li class="nav-item"><a href="#donation-flow"><span class="nav-icon">ğŸ”„</span>æ”¯æ´ãƒ•ãƒ­ãƒ¼</a></li>
                <li class="nav-item"><a href="#webhook"><span class="nav-icon">ğŸ””</span>Webhookå‡¦ç†</a></li>
                <li class="nav-item"><a href="#data-model"><span class="nav-icon">ğŸ’¾</span>ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«</a></li>
                <li class="nav-item"><a href="#infrastructure"><span class="nav-icon">â˜ï¸</span>ã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆ</a></li>
            </ul>
        </div>
        <div class="nav-section">
            <div class="nav-label">é–‹ç™º</div>
            <ul class="nav-list">
                <li class="nav-item"><a href="#dev-flow"><span class="nav-icon">ğŸš€</span>é–‹ç™ºãƒ•ãƒ­ãƒ¼</a></li>
                <li class="nav-item"><a href="#roadmap"><span class="nav-icon">ğŸ“</span>ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—</a></li>
                <li class="nav-item"><a href="#demo-test"><span class="nav-icon">ğŸ§ª</span>ãƒ‡ãƒ¢ç‰ˆãƒ†ã‚¹ãƒˆ</a></li>
                <li class="nav-item"><a href="#ai-guide"><span class="nav-icon">ğŸ¤–</span>AIé–‹ç™ºã‚¬ã‚¤ãƒ‰</a></li>
            </ul>
        </div>
    </nav>

    <!-- MAIN -->
    <main class="main-content">
        <!-- HERO -->
        <div class="hero">
            <div class="hero-content">
                <div class="hero-eyebrow">
                    <span>â—</span> Sandboxç’°å¢ƒç¨¼åƒä¸­
                </div>
                <h1>ã‚¿ãƒ€ã‚«ãƒ¨<br>QRãƒãƒ£ãƒªãƒ†ã‚£ãƒ»ã‚³ãƒã‚¯ãƒˆ</h1>
                <p>
                    NPOæ³•äººã‚¿ãƒ€ã‚«ãƒ¨ã®æ´»å‹•ã‚’æ”¯æ´ã™ã‚‹ãŸã‚ã®æ±ºæ¸ˆãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã€‚
                    <span class="hero-highlight">QRã‚³ãƒ¼ãƒ‰ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã™ã‚‹ã ã‘ã§ã€PayPayæ±ºæ¸ˆãƒšãƒ¼ã‚¸ã«ç›´æ¥é·ç§»</span>ã€‚
                    æœ€çŸ­2ã‚¿ãƒƒãƒ—ã§æ”¯æ´ãŒå®Œäº†ã—ã¾ã™ã€‚
                </p>
            </div>
        </div>

        <div class="content-wrapper">
            <!-- æ¦‚è¦ -->
            <section id="overview">
                <div class="section-header">
                    <div class="section-icon">ğŸ“‹</div>
                    <h2>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦</h2>
                </div>

                <div class="alert alert-success">
                    <span class="alert-icon">âœ“</span>
                    <div class="alert-content">
                        <h4>é‡è¦ï¼šå¯¾ä¾¡æ€§ã®ã‚ã‚‹å–å¼•ï¼ˆå£²ä¸Šï¼‰</h4>
                        <p>ã‚¿ãƒ€ã‚«ãƒ¨ã®ã€Œæ”¯æ´ã€ã¯ã€ç ”ä¿®ã®æä¾›ã‚„ã‚°ãƒƒã‚ºã®æä¾›ãªã©<strong>å¯¾ä¾¡æ€§ã®ã‚ã‚‹å–å¼•</strong>ã§ã‚ã‚Šã€çµŒç†ä¸Šã¯ã€Œå£²ä¸Šã€ã¨ã—ã¦è¨ˆä¸Šã—ã¾ã™ã€‚ã“ã®ä½ç½®ã¥ã‘ã«ã‚ˆã‚Šã€PayPay for Developers / æ¥½å¤©ãƒšã‚¤ã¯<strong>å•†å–å¼•ç”¨é€”</strong>ã¨ã—ã¦é©åˆã—ã¾ã™ã€‚</p>
                    </div>
                </div>

                <div class="card-grid">
                    <div class="feature-card">
                        <h4>ğŸ“± QRã‚³ãƒ¼ãƒ‰â†’å³æ±ºæ¸ˆ</h4>
                        <p>é‡‘é¡ä»˜ãQRã‚³ãƒ¼ãƒ‰ã‚’ã‚¹ã‚­ãƒ£ãƒ³â†’PayPayã§å³æ±ºæ¸ˆã€‚æœ€çŸ­2ã‚¿ãƒƒãƒ—ã§æ”¯æ´å®Œäº†ã€‚</p>
                    </div>
                    <div class="feature-card">
                        <h4>ğŸ¯ å›ºå®šé‡‘é¡QRã‚³ãƒ¼ãƒ‰</h4>
                        <p>500å††/1,000å††/3,000å††/5,000å††ã®QRã‚³ãƒ¼ãƒ‰ã‚’ç™ºè¡Œã€‚ãƒãƒ©ã‚·ãƒ»ååˆºã«æœ€é©ã€‚</p>
                    </div>
                    <div class="feature-card">
                        <h4>ğŸ“Š æµå…¥å…ƒãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°</h4>
                        <p>ãƒãƒ©ã‚·ãƒ»ååˆºãƒ»ã‚¤ãƒ™ãƒ³ãƒˆã”ã¨ã®åŠ¹æœæ¸¬å®šã§ã€ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°æ”¹å–„ã«æ´»ç”¨ã€‚</p>
                    </div>
                    <div class="feature-card">
                        <h4>ğŸ’° ä½ã‚³ã‚¹ãƒˆé‹ç”¨</h4>
                        <p>GCPã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹æ§‹æˆã«ã‚ˆã‚‹å¾“é‡èª²é‡‘ã€‚ã‚¢ã‚¯ã‚»ã‚¹ãŒãªã„æ™‚ã¯èª²é‡‘ã‚¼ãƒ­ã€‚</p>
                    </div>
                </div>

                <h3>æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯</h3>
                <div class="tech-stack">
                    <span class="tech-tag">Cloud Run</span>
                    <span class="tech-tag">Cloud Firestore</span>
                    <span class="tech-tag">Secret Manager</span>
                    <span class="tech-tag">Cloud NAT</span>
                    <span class="tech-tag">Terraform</span>
                    <span class="tech-tag">Python / FastAPI</span>
                    <span class="tech-tag">PayPay API</span>
                    <span class="tech-tag">æ¥½å¤©ãƒšã‚¤ API</span>
                </div>
            </section>

            <!-- ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ -->
            <section id="architecture">
                <div class="section-header">
                    <div class="section-icon">ğŸ—ï¸</div>
                    <h2>ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£</h2>
                </div>
                <p>GCPã®ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹è£½å“ç¾¤ã‚’æ´»ç”¨ã—ã€ä½ã‚³ã‚¹ãƒˆãƒ»é«˜ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»é«˜æ‹¡å¼µæ€§ã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚</p>

                <div class="mermaid">
graph TB
    subgraph "Physical World"
        QR1[ãƒãƒ©ã‚· QR]
        QR2[ååˆº QR]
        QR3[ã‚¤ãƒ™ãƒ³ãƒˆæŠ•å½± QR]
    end

    subgraph "User"
        Phone[ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³]
    end

    subgraph "GCP: tadakayo-qr-connect"
        subgraph "Compute"
            CR[Cloud Run<br/>Backend Service]
        end

        subgraph "Data"
            FS[(Firestore<br/>æ”¯æ´è¨˜éŒ²)]
            SM[Secret Manager<br/>APIã‚­ãƒ¼/ç½²åéµ]
        end

        subgraph "Network"
            NAT[Cloud NAT<br/>å›ºå®šIP]
            VPC[VPC Network]
        end
    end

    subgraph "External Payment APIs"
        PP[PayPay API]
        RP[æ¥½å¤©ãƒšã‚¤ API]
    end

    QR1 & QR2 & QR3 -->|ã‚¹ã‚­ãƒ£ãƒ³| Phone
    Phone -->|HTTPS| CR
    CR -->|èª­ã¿æ›¸ã| FS
    CR -->|å–å¾—| SM
    CR --> VPC --> NAT
    NAT -->|API Call| PP & RP
    PP & RP -->|Webhook| CR
                </div>

                <div class="alert alert-info">
                    <span class="alert-icon">ğŸ’¡</span>
                    <div class="alert-content">
                        <h4>AIé–‹ç™ºã®ãƒã‚¤ãƒ³ãƒˆ</h4>
                        <p>ã“ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³ã‚’å‚ç…§ã—ã¦ã€å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“ã®ä¾å­˜é–¢ä¿‚ã‚’æŠŠæ¡ã—ã¦ãã ã•ã„ã€‚æ–°æ©Ÿèƒ½è¿½åŠ æ™‚ã¯ã€å½±éŸ¿ã‚’å—ã‘ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ç‰¹å®šã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚</p>
                    </div>
                </div>
            </section>

            <!-- æ”¯æ´ãƒ•ãƒ­ãƒ¼ -->
            <section id="donation-flow">
                <div class="section-header">
                    <div class="section-icon">ğŸ”„</div>
                    <h2>æ”¯æ´ãƒ•ãƒ­ãƒ¼ï¼ˆã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ï¼‰</h2>
                </div>
                <p>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒQRã‚³ãƒ¼ãƒ‰ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã¦ã‹ã‚‰æ”¯æ´æ±ºæ¸ˆãŒå®Œäº†ã™ã‚‹ã¾ã§ã®æµã‚Œã§ã™ã€‚</p>

                <div class="mermaid">
sequenceDiagram
    autonumber
    participant U as ãƒ¦ãƒ¼ã‚¶ãƒ¼
    participant QR as QRã‚³ãƒ¼ãƒ‰
    participant CR as Cloud Run
    participant SM as Secret Manager
    participant FS as Firestore
    participant PP as PayPay/æ¥½å¤©ãƒšã‚¤

    U->>QR: QRã‚³ãƒ¼ãƒ‰ã‚’ã‚¹ã‚­ãƒ£ãƒ³
    QR->>CR: GET /donate?source=flyer_001
    CR->>FS: æµå…¥å…ƒã‚’è¨˜éŒ²
    CR->>U: é‡‘é¡é¸æŠãƒšãƒ¼ã‚¸ã‚’è¡¨ç¤º
    U->>CR: é‡‘é¡ã‚’é¸æŠ (ä¾‹: 1,000å††)
    CR->>SM: APIã‚­ãƒ¼ã‚’å–å¾—
    SM-->>CR: APIã‚­ãƒ¼
    CR->>PP: æ±ºæ¸ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆä½œæˆ
    PP-->>CR: æ±ºæ¸ˆURL
    CR->>U: æ±ºæ¸ˆç”»é¢ã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
    U->>PP: æ±ºæ¸ˆã‚’å®Ÿè¡Œ
    PP-->>U: æ±ºæ¸ˆå®Œäº†
    PP->>CR: Webhooké€šçŸ¥
    CR->>SM: ç½²åæ¤œè¨¼éµã‚’å–å¾—
    SM-->>CR: ç½²åéµ
    CR->>CR: ç½²åæ¤œè¨¼
    CR->>FS: æ±ºæ¸ˆçµæœã‚’ä¿å­˜
    CR->>U: ã‚µãƒ³ã‚¯ã‚¹ãƒšãƒ¼ã‚¸ã‚’è¡¨ç¤º
                </div>

                <div class="alert alert-warning">
                    <span class="alert-icon">âš ï¸</span>
                    <div class="alert-content">
                        <h4>é‡è¦</h4>
                        <p>ã‚¹ãƒ†ãƒƒãƒ—14-15ã®ç½²åæ¤œè¨¼ã¯å¿…é ˆã§ã™ã€‚ã“ã‚Œã‚’çœç•¥ã™ã‚‹ã¨ã€ä¸æ­£ãªWebhooké€šçŸ¥ã‚’å—ã‘å…¥ã‚Œã‚‹ãƒªã‚¹ã‚¯ãŒã‚ã‚Šã¾ã™ã€‚</p>
                    </div>
                </div>
            </section>

            <!-- Webhookå‡¦ç† -->
            <section id="webhook">
                <div class="section-header">
                    <div class="section-icon">ğŸ””</div>
                    <h2>Webhookå‡¦ç†ãƒ•ãƒ­ãƒ¼</h2>
                </div>
                <p>æ±ºæ¸ˆãƒ—ãƒ­ãƒã‚¤ãƒ€ã‹ã‚‰ã®Webhooké€šçŸ¥ã‚’å®‰å…¨ã«å‡¦ç†ã™ã‚‹ãƒ•ãƒ­ãƒ¼ã§ã™ã€‚</p>

                <div class="mermaid">
flowchart TD
    A[Webhookå—ä¿¡] --> B{ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ¤œè¨¼}
    B -->|ç„¡åŠ¹| C[400 Bad Request]
    B -->|æœ‰åŠ¹| D[ç½²åæ¤œè¨¼]
    D -->|å¤±æ•—| E[401 Unauthorized]
    D -->|æˆåŠŸ| F{ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒ—åˆ¤å®š}

    F -->|payment.completed| G[æ±ºæ¸ˆå®Œäº†å‡¦ç†]
    F -->|payment.failed| H[æ±ºæ¸ˆå¤±æ•—å‡¦ç†]
    F -->|payment.refunded| I[è¿”é‡‘å‡¦ç†]
    F -->|unknown| J[ãƒ­ã‚°è¨˜éŒ²ã®ã¿]

    G --> K[Firestoreã«ä¿å­˜]
    H --> K
    I --> K
    J --> L[200 OK]
    K --> L

    subgraph "ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯"
        B
        D
    end

    subgraph "ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯"
        F
        G
        H
        I
        J
    end
                </div>

                <h3>ç½²åæ¤œè¨¼ã®å®Ÿè£…ä¾‹</h3>
                <div class="code-block">
<span style="color: var(--accent-purple);">// Node.js ã§ã®ç½²åæ¤œè¨¼ä¾‹</span>
<span style="color: var(--accent-blue);">const</span> crypto = <span style="color: var(--accent-blue);">require</span>(<span style="color: var(--accent-green);">'crypto'</span>);

<span style="color: var(--accent-blue);">function</span> <span style="color: var(--accent-yellow);">verifySignature</span>(payload, signature, secret) {
  <span style="color: var(--accent-blue);">const</span> expected = crypto
    .<span style="color: var(--accent-yellow);">createHmac</span>(<span style="color: var(--accent-green);">'sha256'</span>, secret)
    .<span style="color: var(--accent-yellow);">update</span>(payload)
    .<span style="color: var(--accent-yellow);">digest</span>(<span style="color: var(--accent-green);">'hex'</span>);
  <span style="color: var(--accent-blue);">return</span> crypto.<span style="color: var(--accent-yellow);">timingSafeEqual</span>(
    Buffer.<span style="color: var(--accent-yellow);">from</span>(signature),
    Buffer.<span style="color: var(--accent-yellow);">from</span>(expected)
  );
}
                </div>
            </section>

            <!-- ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ« -->
            <section id="data-model">
                <div class="section-header">
                    <div class="section-icon">ğŸ’¾</div>
                    <h2>ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«</h2>
                </div>
                <p>Firestoreï¼ˆNoSQLï¼‰ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³æ§‹é€ ã§ã™ã€‚</p>

                <div class="mermaid">
erDiagram
    donations {
        string id PK "è‡ªå‹•ç”ŸæˆID"
        string source "æµå…¥å…ƒ(flyer_001ç­‰)"
        int amount "æ”¯æ´é‡‘é¡"
        string currency "é€šè²¨(JPY)"
        string payment_provider "æ±ºæ¸ˆãƒ—ãƒ­ãƒã‚¤ãƒ€"
        string payment_id "æ±ºæ¸ˆãƒ—ãƒ­ãƒã‚¤ãƒ€ã®ID"
        string status "pending/completed/failed/refunded"
        timestamp created_at "ä½œæˆæ—¥æ™‚"
        timestamp updated_at "æ›´æ–°æ—¥æ™‚"
    }

    qr_sources {
        string id PK "QRã‚½ãƒ¼ã‚¹ID(flyer_001ç­‰)"
        string name "è¡¨ç¤ºå"
        string type "flyer/card/event"
        string description "èª¬æ˜"
        boolean active "æœ‰åŠ¹ãƒ•ãƒ©ã‚°"
        timestamp created_at "ä½œæˆæ—¥æ™‚"
    }

    webhook_logs {
        string id PK "è‡ªå‹•ç”ŸæˆID"
        string provider "PayPay/RakutenPay"
        string event_type "ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒ—"
        string payment_id "é–¢é€£ã™ã‚‹æ±ºæ¸ˆID"
        object raw_payload "ç”Ÿã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰"
        boolean signature_valid "ç½²åæ¤œè¨¼çµæœ"
        timestamp received_at "å—ä¿¡æ—¥æ™‚"
    }

    donations ||--o{ webhook_logs : "payment_id"
    qr_sources ||--o{ donations : "source"
                </div>

                <h3>ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³è©³ç´°</h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³</th>
                                <th>ç”¨é€”</th>
                                <th>ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>donations</code></td>
                                <td>æ”¯æ´è¨˜éŒ²ã®ä¿å­˜</td>
                                <td>source, status, created_at</td>
                            </tr>
                            <tr>
                                <td><code>qr_sources</code></td>
                                <td>QRã‚³ãƒ¼ãƒ‰æµå…¥å…ƒã®ç®¡ç†</td>
                                <td>type, active</td>
                            </tr>
                            <tr>
                                <td><code>webhook_logs</code></td>
                                <td>Webhooké€šçŸ¥ã®ãƒ­ã‚°ï¼ˆç›£æŸ»ç”¨ï¼‰</td>
                                <td>provider, received_at</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- ã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆ -->
            <section id="infrastructure">
                <div class="section-header">
                    <div class="section-icon">â˜ï¸</div>
                    <h2>ã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆï¼ˆGCPï¼‰</h2>
                </div>
                <p>Terraformã§ç®¡ç†ã™ã‚‹GCPãƒªã‚½ãƒ¼ã‚¹ã®æ§‹æˆã§ã™ã€‚</p>

                <div class="mermaid">
graph TB
    subgraph "GCP Project: tadakayo-qr-connect"
        subgraph "IAM"
            SA[Service Account<br/>cloud-run-sa]
        end

        subgraph "Networking"
            VPC[VPC Network<br/>donation-vpc]
            SUBNET[Subnet<br/>asia-northeast1]
            ROUTER[Cloud Router]
            NAT[Cloud NAT<br/>å›ºå®šIP: x.x.x.x]
            VPC --> SUBNET
            SUBNET --> ROUTER --> NAT
        end

        subgraph "Serverless"
            CR[Cloud Run<br/>donation-api]
            CR -.->|VPC Connector| VPC
        end

        subgraph "Data & Security"
            FS[(Firestore<br/>Native Mode)]
            SM[Secret Manager]
        end

        subgraph "Observability"
            LOG[Cloud Logging]
            MON[Cloud Monitoring]
            ERR[Error Reporting]
        end

        SA -->|æ¨©é™| CR
        SA -->|æ¨©é™| FS
        SA -->|æ¨©é™| SM
        CR --> LOG
        LOG --> MON
        LOG --> ERR
    end

    EXT[External<br/>Payment APIs] -->|Webhook| CR
    NAT -->|API Call| EXT
                </div>

                <h3>å›ºå®šIPãŒå¿…è¦ãªç†ç”±</h3>
                <div class="card">
                    <p style="margin: 0;">PayPayã‚„æ¥½å¤©ãƒšã‚¤ã®APIã¯ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãŸã‚æ¥ç¶šå…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆç™»éŒ²ã‚’æ±‚ã‚ã¦ã„ã¾ã™ã€‚Cloud NATã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ç’°å¢ƒã§ã‚‚å›ºå®šIPã‹ã‚‰ã®é€šä¿¡ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚</p>
                </div>
            </section>

            <!-- é–‹ç™ºãƒ•ãƒ­ãƒ¼ -->
            <section id="dev-flow">
                <div class="section-header">
                    <div class="section-icon">ğŸš€</div>
                    <h2>é–‹ç™ºãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ•ãƒ­ãƒ¼</h2>
                </div>
                <p>GitHubã¨GCPã‚’é€£æºã—ãŸCI/CDãƒ•ãƒ­ãƒ¼ã§ã™ã€‚</p>

                <div class="mermaid">
flowchart LR
    subgraph "Local Development"
        DEV[é–‹ç™ºè€…]
        CODE[ã‚³ãƒ¼ãƒ‰å¤‰æ›´]
        TEST[ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆ]
    end

    subgraph "GitHub"
        PR[Pull Request]
        REVIEW[ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼]
        MAIN[main branch]
    end

    subgraph "CI/CD"
        CI[GitHub Actions<br/>Lint & Test]
        BUILD[Docker Build]
        DEPLOY[Cloud Run Deploy]
    end

    subgraph "GCP"
        STG[Stagingç’°å¢ƒ]
        PROD[Productionç’°å¢ƒ]
    end

    DEV --> CODE --> TEST --> PR
    PR --> CI
    CI -->|Pass| REVIEW
    CI -->|Fail| DEV
    REVIEW -->|Approve| MAIN
    MAIN --> BUILD --> DEPLOY
    DEPLOY --> STG
    STG -->|Manual Approval| PROD
                </div>

                <h3>ãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥</h3>
                <div class="mermaid">
gitGraph
    commit id: "initial"
    branch feature/payment-api
    checkout feature/payment-api
    commit id: "add PayPay"
    commit id: "add webhook"
    checkout main
    merge feature/payment-api id: "PR #1"
    branch feature/tracking
    checkout feature/tracking
    commit id: "add source tracking"
    checkout main
    merge feature/tracking id: "PR #2"
    commit id: "release v1.0"
                </div>
            </section>

            <!-- ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ— -->
            <section id="roadmap">
                <div class="section-header">
                    <div class="section-icon">ğŸ“</div>
                    <h2>é–‹ç™ºãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—</h2>
                </div>

                <div class="alert alert-success">
                    <span class="alert-icon">ğŸ‰</span>
                    <div class="alert-content">
                        <h4>ãƒ‡ãƒ¢ç‰ˆå…¬é–‹ä¸­ï¼</h4>
                        <p>PayPay SDK Sandboxæ¥ç¶šç¢ºèªæ¸ˆã¿ã€‚QRã‚³ãƒ¼ãƒ‰æ±ºæ¸ˆã®å®Œå…¨ãªãƒ•ãƒ­ãƒ¼ã‚’ãƒ†ã‚¹ãƒˆã§ãã¾ã™ã€‚<br>
                        <strong>æœ€æ–°æ›´æ–°</strong>ï¼ˆ2026/01/25ï¼‰: UIã‚’QRã‚³ãƒ¼ãƒ‰æ±ºæ¸ˆä¸­å¿ƒã«åˆ·æ–°</p>
                        <div style="margin-top: 12px; display: flex; gap: 16px;">
                            <a href="https://qr-payment-api-sandbox-yggvw3tpqa-an.a.run.app/donate" target="_blank" style="color: var(--accent-green); font-weight: 600;">æ”¯æ´ãƒšãƒ¼ã‚¸ â†’</a>
                            <a href="https://qr-payment-api-sandbox-yggvw3tpqa-an.a.run.app/qr/500" target="_blank" style="color: var(--accent-green); font-weight: 600;">500å††QRã‚³ãƒ¼ãƒ‰ â†’</a>
                        </div>
                    </div>
                </div>

                <h3>ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³è©³ç´°</h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>ãƒ•ã‚§ãƒ¼ã‚º</th>
                                <th>ç›®æ¨™</th>
                                <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ç¬¬1æ®µéš: å¥‘ç´„ãƒ»æº–å‚™</td>
                                <td>æ±ºæ¸ˆãƒ—ãƒ­ãƒã‚¤ãƒ€ã¸ã®ç”³è«‹ãƒ»å¥‘ç´„</td>
                                <td><span class="status status-progress">ç”³è«‹æº–å‚™ä¸­</span></td>
                            </tr>
                            <tr>
                                <td>ç¬¬2æ®µéš: ã‚¤ãƒ³ãƒ•ãƒ©æ•´å‚™</td>
                                <td>GCPåŸºç›¤æ§‹ç¯‰ï¼ˆCloud Run / Firestore / NATï¼‰</td>
                                <td><span class="status status-done">å®Œäº†</span></td>
                            </tr>
                            <tr>
                                <td>ç¬¬3æ®µéš: MVPå®Ÿè£…</td>
                                <td>æ”¯æ´ãƒšãƒ¼ã‚¸ã€æ±ºæ¸ˆAPIé€£æºã€Webhookã€å›ºå®šé‡‘é¡QRã‚³ãƒ¼ãƒ‰</td>
                                <td><span class="status status-done">Sandboxæ¥ç¶šæ¸ˆã¿</span></td>
                            </tr>
                            <tr>
                                <td>ç¬¬4æ®µéš: è¤‡æ•°æ±ºæ¸ˆ</td>
                                <td>PayPayãƒ»æ¥½å¤©ãƒšã‚¤ä¸¡å¯¾å¿œ</td>
                                <td><span class="status status-done">ãƒ¢ãƒƒã‚¯ç‰ˆå®Œäº†</span></td>
                            </tr>
                            <tr>
                                <td>ç¬¬5æ®µéš: é‹ç”¨ãƒ»åˆ†æ</td>
                                <td>GA4ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã€æ±ºæ¸ˆæˆåŠŸç‡ã®å¯è¦–åŒ–</td>
                                <td><span class="status status-pending">äºˆå®š</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3>æ§‹ç¯‰æ¸ˆã¿ãƒªã‚½ãƒ¼ã‚¹</h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>ãƒªã‚½ãƒ¼ã‚¹</th>
                                <th>è©³ç´°</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Cloud Run</td>
                                <td><code>qr-payment-api-sandbox</code> - ãƒ‡ãƒ—ãƒ­ã‚¤æ¸ˆã¿</td>
                            </tr>
                            <tr>
                                <td>Cloud NAT</td>
                                <td>å›ºå®šIP: <code>34.84.72.66</code></td>
                            </tr>
                            <tr>
                                <td>Terraform</td>
                                <td><code>infrastructure/environments/sandbox/</code></td>
                            </tr>
                            <tr>
                                <td>CI/CD</td>
                                <td>GitHub Actionsï¼ˆè‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ï¼‰</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3>æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h3>
                <div class="card">
                    <ul>
                        <li><strong>PayPay for Developers</strong> ã¸ã®å•†å–å¼•ç”³è«‹</li>
                        <li><strong>æ¥½å¤©ãƒšã‚¤ï¼ˆã‚ªãƒ³ãƒ©ã‚¤ãƒ³æ±ºæ¸ˆï¼‰</strong> ã¸ã®å•†å–å¼•ç”³è«‹</li>
                        <li>å¯©æŸ»é€šéå¾Œã€æœ¬ç•ªç”¨APIã‚­ãƒ¼ã‚’è¨­å®š</li>
                        <li>æ­£å¼ç‰ˆå…¬é–‹ã€QRã‚³ãƒ¼ãƒ‰ç™ºè¡Œ</li>
                    </ul>
                </div>
            </section>

            <!-- ãƒ‡ãƒ¢ç‰ˆãƒ†ã‚¹ãƒˆ -->
            <section id="demo-test">
                <div class="section-header">
                    <div class="section-icon">ğŸ§ª</div>
                    <h2>ãƒ‡ãƒ¢ç‰ˆã®ãƒ†ã‚¹ãƒˆæ–¹æ³•</h2>
                </div>

                <div class="alert alert-warning">
                    <span class="alert-icon">âš ï¸</span>
                    <div class="alert-content">
                        <h4>PayPay Sandboxãƒ†ã‚¹ãƒˆã®æ³¨æ„</h4>
                        <p>ãƒ‡ãƒ¢ç‰ˆã¯PayPay Sandboxï¼ˆãƒ†ã‚¹ãƒˆç’°å¢ƒï¼‰ã«æ¥ç¶šã—ã¦ã„ã¾ã™ã€‚<br>
                        <strong>é€šå¸¸ã®PayPayã‚¢ãƒ—ãƒªã§ã¯QRã‚³ãƒ¼ãƒ‰ã‚’èª­ã¿å–ã‚Œã¾ã›ã‚“ã€‚</strong></p>
                    </div>
                </div>

                <h3>ãƒ†ã‚¹ãƒˆã«å¿…è¦ãªã‚‚ã®</h3>
                <div class="card-grid">
                    <div class="feature-card">
                        <h4>1ï¸âƒ£ PayPay Sandboxã‚¢ãƒ—ãƒª</h4>
                        <p>é€šå¸¸ã®PayPayã‚¢ãƒ—ãƒªã¨ã¯åˆ¥ã®ã€é–‹ç™ºè€…å‘ã‘å°‚ç”¨ãƒ†ã‚¹ãƒˆã‚¢ãƒ—ãƒªã§ã™ã€‚</p>
                        <ul style="margin-top: 12px; padding-left: 20px; font-size: 0.9rem;">
                            <li>iOS: TestFlightçµŒç”±ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</li>
                            <li>Android: APKãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</li>
                        </ul>
                    </div>
                    <div class="feature-card">
                        <h4>2ï¸âƒ£ ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</h4>
                        <p>PayPayé–‹ç™ºè€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ç™ºè¡Œã•ã‚Œã‚‹ãƒ†ã‚¹ãƒˆç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ã™ã€‚</p>
                        <ul style="margin-top: 12px; padding-left: 20px; font-size: 0.9rem;">
                            <li>ä»®æƒ³æ®‹é«˜ï¼ˆÂ¥100,000ï¼‰ãŒè¨­å®šæ¸ˆã¿</li>
                            <li>å®Ÿéš›ã®æ±ºæ¸ˆã¯ç™ºç”Ÿã—ã¾ã›ã‚“</li>
                        </ul>
                    </div>
                </div>

                <h3>ãƒ†ã‚¹ãƒˆæ‰‹é †</h3>
                <div class="card">
                    <ol>
                        <li><strong>PayPay Sandboxã‚¢ãƒ—ãƒª</strong>ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆPayPayé–‹ç™ºè€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼‰</li>
                        <li>Sandboxã‚¢ãƒ—ãƒªã§<strong>ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</strong>ã«ãƒ­ã‚°ã‚¤ãƒ³</li>
                        <li><a href="https://qr-payment-api-sandbox-yggvw3tpqa-an.a.run.app/donate" target="_blank" style="color: var(--accent-blue);">ãƒ‡ãƒ¢ç‰ˆæ”¯æ´ãƒšãƒ¼ã‚¸</a>ã§é‡‘é¡ã‚’é¸æŠã—QRã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤º</li>
                        <li>Sandboxã‚¢ãƒ—ãƒªã§<strong>QRã‚³ãƒ¼ãƒ‰ã‚’ã‚¹ã‚­ãƒ£ãƒ³</strong></li>
                        <li>æ±ºæ¸ˆã‚’å®Ÿè¡Œ â†’ ã‚µãƒ³ã‚¯ã‚¹ãƒšãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°æˆåŠŸ</li>
                    </ol>
                </div>

                <div class="alert alert-info">
                    <span class="alert-icon">ğŸ’¡</span>
                    <div class="alert-content">
                        <h4>æ­£å¼ç‰ˆã«ã¤ã„ã¦</h4>
                        <p>PayPayã®åŠ ç›Ÿåº—å¯©æŸ»é€šéå¾Œã€æ­£å¼ç‰ˆã‚’å…¬é–‹äºˆå®šã§ã™ã€‚æ­£å¼ç‰ˆã§ã¯<strong>é€šå¸¸ã®PayPayã‚¢ãƒ—ãƒª</strong>ã§æ±ºæ¸ˆãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚</p>
                    </div>
                </div>
            </section>

            <!-- AIé–‹ç™ºã‚¬ã‚¤ãƒ‰ -->
            <section id="ai-guide">
                <div class="section-header">
                    <div class="section-icon">ğŸ¤–</div>
                    <h2>AIé§†å‹•é–‹ç™ºã‚¬ã‚¤ãƒ‰</h2>
                </div>
                <p>Claude Codeãªã©ã®AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã¨å”åƒã™ã‚‹éš›ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã§ã™ã€‚</p>

                <h3>ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå…±æœ‰ç”¨ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ</h3>
                <div class="card">
                    <p>AIã«ä½œæ¥­ã‚’ä¾é ¼ã™ã‚‹éš›ã¯ã€ä»¥ä¸‹ã®æƒ…å ±ã‚’æä¾›ã—ã¦ãã ã•ã„ï¼š</p>
                    <ul style="margin-top: 12px;">
                        <li>å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«/ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</li>
                        <li>æœŸå¾…ã™ã‚‹å‹•ä½œï¼ˆå—ã‘å…¥ã‚Œæ¡ä»¶ï¼‰</li>
                        <li>é–¢é€£ã™ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆã“ã®ãƒšãƒ¼ã‚¸ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼‰</li>
                        <li>åˆ¶ç´„äº‹é …ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç­‰ï¼‰</li>
                    </ul>
                </div>

                <h3>é‡è¦ãªè¨­è¨ˆæ±ºå®šï¼ˆADRï¼‰</h3>
                <div class="mermaid">
mindmap
    root((è¨­è¨ˆæ±ºå®š))
        ADR-001
            Cloud Runæ¡ç”¨
            ã‚ªãƒ¼ãƒˆã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
            å¾“é‡èª²é‡‘
        ADR-002
            Cloud NAT
            å›ºå®šIP
            æ±ºæ¸ˆAPIå¯¾å¿œ
        ADR-003
            Firestore
            ã‚¹ã‚­ãƒ¼ãƒãƒ¬ã‚¹
            æ‹¡å¼µæ€§é‡è¦–
                </div>

                <h3>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ</h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>é …ç›®</th>
                                <th>ç¢ºèªäº‹é …</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ç½²åæ¤œè¨¼</td>
                                <td>Webhooké€šçŸ¥ã®ç½²åã‚’å¿…ãšæ¤œè¨¼</td>
                            </tr>
                            <tr>
                                <td>ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆç®¡ç†</td>
                                <td>APIã‚­ãƒ¼/ç½²åéµã¯Secret Managerã§ç®¡ç†</td>
                            </tr>
                            <tr>
                                <td>ãƒ­ã‚°å‡ºåŠ›</td>
                                <td>APIã‚­ãƒ¼ã€ç½²åéµã€PIIã‚’ãƒ­ã‚°ã«å‡ºåŠ›ã—ãªã„</td>
                            </tr>
                            <tr>
                                <td>å…¥åŠ›æ¤œè¨¼</td>
                                <td>é‡‘é¡ã€sourceç­‰ã®å…¥åŠ›å€¤ã‚’æ¤œè¨¼</td>
                            </tr>
                            <tr>
                                <td>è¦ç´„é©åˆæ€§</td>
                                <td>å•†å–å¼•ã¨ã—ã¦ç”³è«‹ï¼ˆå¯¾ä¾¡æ€§ã®ã‚ã‚‹å–å¼•ï¼‰</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="alert alert-info">
                    <span class="alert-icon">ğŸ“</span>
                    <div class="alert-content">
                        <h4>AIã¸ã®ä¾é ¼ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</h4>
                        <p><strong>ç›®çš„:</strong> [ä½•ã‚’é”æˆã—ãŸã„ã‹]<br>
                        <strong>å¯¾è±¡:</strong> [å¤‰æ›´ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«/ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ]<br>
                        <strong>åˆ¶ç´„:</strong> [å®ˆã‚‹ã¹ããƒ«ãƒ¼ãƒ«]<br>
                        <strong>å—ã‘å…¥ã‚Œæ¡ä»¶:</strong> [å®Œäº†ã®å®šç¾©]</p>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- FOOTER -->
    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-brand">ã‚¿ãƒ€ã‚«ãƒ¨ QRãƒãƒ£ãƒªãƒ†ã‚£ãƒ»ã‚³ãƒã‚¯ãƒˆ</div>
            <div class="footer-links">
                <a href="https://mmky310.info/" target="_blank">ã‚¿ãƒ€ã‚«ãƒ¨å…¬å¼ã‚µã‚¤ãƒˆ</a>
                <a href="https://github.com/yasushi-honda-prog/tadakayo-qr-charity-connect" target="_blank">GitHub Repository</a>
            </div>
            <div class="footer-meta">Built with AI-Driven Development</div>
        </div>
    </footer>

    <script>
        // Theme management
        function getPreferredTheme() {
            const stored = localStorage.getItem('theme');
            if (stored) return stored;
            return window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark';
        }

        function setTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            // Reinitialize mermaid with new theme
            updateMermaidTheme(theme);
        }

        function toggleTheme() {
            const current = document.documentElement.getAttribute('data-theme') || 'dark';
            const next = current === 'dark' ? 'light' : 'dark';
            setTheme(next);
        }

        function updateMermaidTheme(theme) {
            mermaid.initialize({
                startOnLoad: false,
                theme: theme === 'light' ? 'default' : 'dark',
                securityLevel: 'loose',
                flowchart: { useMaxWidth: true },
                sequence: { useMaxWidth: true },
                gantt: { useMaxWidth: true }
            });
            // Re-render all mermaid diagrams
            document.querySelectorAll('.mermaid').forEach((el, i) => {
                const code = el.getAttribute('data-mermaid-src');
                if (code) {
                    el.innerHTML = code;
                    el.removeAttribute('data-processed');
                    mermaid.init(undefined, el);
                }
            });
        }

        // Initialize theme before page renders
        (function() {
            const theme = getPreferredTheme();
            document.documentElement.setAttribute('data-theme', theme);
        })();

        // Listen for system theme changes
        window.matchMedia('(prefers-color-scheme: light)').addEventListener('change', (e) => {
            if (!localStorage.getItem('theme')) {
                setTheme(e.matches ? 'light' : 'dark');
            }
        });

        // Mermaid init
        const currentTheme = getPreferredTheme();
        mermaid.initialize({
            startOnLoad: true,
            theme: currentTheme === 'light' ? 'default' : 'dark',
            securityLevel: 'loose',
            flowchart: { useMaxWidth: true },
            sequence: { useMaxWidth: true },
            gantt: { useMaxWidth: true }
        });

        // Store original mermaid source for re-rendering
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.mermaid').forEach(el => {
                el.setAttribute('data-mermaid-src', el.textContent);
            });
        });

        // Scroll progress
        window.addEventListener('scroll', () => {
            const scrollProgress = document.getElementById('scrollProgress');
            const scrollTop = window.scrollY;
            const docHeight = document.documentElement.scrollHeight - window.innerHeight;
            const progress = (scrollTop / docHeight) * 100;
            scrollProgress.style.width = progress + '%';
        });

        // Active nav highlight
        const sections = document.querySelectorAll('section[id]');
        const navLinks = document.querySelectorAll('.nav-item a');

        window.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (scrollY >= sectionTop - 200) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + current) {
                    link.classList.add('active');
                }
            });
        });

        // Mobile sidebar toggle
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
        }

        // Close sidebar on link click (mobile)
        navLinks.forEach(link => {
            link.addEventListener('click', () => {
                if (window.innerWidth <= 1024) {
                    document.getElementById('sidebar').classList.remove('open');
                }
            });
        });
    </script>
</body>
</html>
